name: ðŸš’ Create Hotfix Release PRs

on:
    workflow_call:
        secrets:
            GH_BOT_USER:
              required: true
            GH_BOT_PAT:
              required: true
            FONTAWESOME_NPM_AUTH_TOKEN:
              required: false
        inputs:
            branch:
                type: string
                description: The hotfix branch with the fix that shall be released.
                required: true
                default: fix/

jobs:
    create-release-PR:
        name: Create a PR from the hotfix branch into 'release'
        uses: dot-base/.github/.github/workflows/create-release-pr.yml@main
        inputs:
            branch: ${{ inputs.branch }}
          secrets:
            GH_BOT_USER: ${{ secrets.GH_BOT_USER }}
            GH_BOT_PAT: ${{ secrets.GH_BOT_PAT }}
            FONTAWESOME_NPM_AUTH_TOKEN: ${{ secrets.FONTAWESOME_NPM_AUTH_TOKEN }}

    create-feature-PR:
        name: Create a PR from the hotfix branch into 'main'
        uses: repo-sync/pull-request@v2
        with:
          github_token: ${{ secrets.GH_BOT_PAT }}
          source_branch: ${{ inputs.branch }}
          destination_branch: main
          pr_title: "fix(release): ${{ steps.changelog.outputs.tag }}"
          pr_body: "${{ steps.changelog.outputs.clean_changelog }}"
          pr_reviewer: "dot-base/development"
          pr_assignee: ${{ secrets.GH_BOT_USER }}
          pr_milestone: "next"
